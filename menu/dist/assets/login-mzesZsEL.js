let w=!1,u,i,n,a,l,o,c,g;function y(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function d(e,t){e&&(e.textContent=t,e.style.display="block")}function f(e){e&&(e.textContent="",e.style.display="none")}function h(e){o&&(o.textContent=e,o.hidden=!1)}function m(){o&&(o.textContent="",o.hidden=!0)}function p(e){w=e,c&&(c.disabled=e,c.dataset.loading=e),i&&(i.disabled=e),n&&(n.disabled=e)}function E(){let e=!0;f(a),f(l),m();const t=i?.value.trim()||"";t?y(t)||(d(a,"Digite um e-mail válido"),e=!1):(d(a,"Login é obrigatório"),e=!1);const r=n?.value||"";return r?r.length<6&&(d(l,"Senha deve ter no mínimo 6 caracteres"),e=!1):(d(l,"Senha é obrigatória"),e=!1),e}async function b(e,t){if(await new Promise(r=>setTimeout(r,1500)),t.length>=6)return{success:!0,user:{email:e,name:"Usuário Teste"},token:"mock-jwt-token-"+Date.now()};throw new Error("Credenciais inválidas")}async function v(e){if(e.preventDefault(),w||!E())return;const t=i.value.trim(),r=n.value;try{p(!0);const s=await b(t,r);sessionStorage.setItem("authToken",s.token),sessionStorage.setItem("user",JSON.stringify(s.user)),console.log("✅ Login successful, redirecting..."),window.location.hash="#/dashboard"}catch(s){console.error("❌ Login error:",s),h(s.message||"Erro ao fazer login. Tente novamente.")}finally{p(!1)}}function I(){if(!n)return;const e=n.type==="password";n.type=e?"text":"password";const t=e?"Ocultar senha":"Mostrar senha";g?.setAttribute("aria-label",t)}function L(){i?.addEventListener("input",()=>{f(a),m()}),n?.addEventListener("input",()=>{f(l),m()})}function S(){if(u=document.getElementById("loginForm"),i=document.getElementById("loginInput"),n=document.getElementById("passwordInput"),a=document.getElementById("loginError"),l=document.getElementById("passwordError"),o=document.getElementById("loginFormError"),c=u?.querySelector(".login-form-submit"),g=document.querySelector(".login-form-password-toggle"),!u){console.error("Login form not found");return}u.addEventListener("submit",v),g?.addEventListener("click",I),L(),i?.focus(),console.log("✅ Login page initialized")}export{S as init};
