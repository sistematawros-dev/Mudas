let y=!1,o="email",g,p,b,l,d,f,c,s,u,n,v;function $(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function I(e){return e.replace(/\D/g,"").length===11}function F(e){const t=e.replace(/\D/g,"");return t.length===10||t.length===11}function C(e){const t=e.replace(/\D/g,"");return t.length<=3?t:t.length<=6?t.replace(/(\d{3})(\d)/,"$1.$2"):t.length<=9?t.replace(/(\d{3})(\d{3})(\d)/,"$1.$2.$3"):t.replace(/(\d{3})(\d{3})(\d{3})(\d{1,2})/,"$1.$2.$3-$4")}function w(e){const t=e.replace(/\D/g,"");return t.length<=2?t:t.length<=6?t.replace(/(\d{2})(\d)/,"($1) $2"):t.length<=10?t.replace(/(\d{2})(\d{4})(\d)/,"($1) $2-$3"):t.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3")}function i(e,t){e&&(e.textContent=t,e.style.display="block")}function a(e){e&&(e.textContent="",e.style.display="none")}function P(e){n&&(n.textContent=e,n.hidden=!1)}function m(){n&&(n.textContent="",n.hidden=!0)}function E(e){y=e,v&&(v.disabled=e,v.dataset.loading=e),l&&(l.disabled=e),d&&(d.disabled=e),f&&(f.disabled=e),p?.forEach(t=>{t.disabled=e})}function k(e){o=e,p?.forEach(t=>{const r=t.dataset.tab===e;t.classList.toggle("active",r)}),b?.forEach(t=>{const r=t.dataset.content===e;t.classList.toggle("active",r)}),a(c),a(s),a(u),m()}function V(){let e=!0;switch(a(c),a(s),a(u),m(),o){case"email":const t=l?.value.trim()||"";t?$(t)||(i(c,"Digite um e-mail válido"),e=!1):(i(c,"E-mail é obrigatório"),e=!1);break;case"cpf":const r=d?.value||"";r?I(r)||(i(s,"Digite um CPF válido"),e=!1):(i(s,"CPF é obrigatório"),e=!1);break;case"celular":const h=f?.value||"";h?F(h)||(i(u,"Digite um celular válido"),e=!1):(i(u,"Celular é obrigatório"),e=!1);break}return e}async function B(e,t){return await new Promise(r=>setTimeout(r,1500)),{success:!0,method:e,message:"Instruções enviadas com sucesso!"}}async function D(e){if(e.preventDefault(),y||!V())return;let t;switch(o){case"email":t=l.value.trim();break;case"cpf":t=d.value;break;case"celular":t=f.value;break}try{E(!0);const r=await B(o,t);console.log("✅ Recovery email sent successfully"),alert(`${r.message}

Verifique ${o==="email"?"seu e-mail":o==="cpf"?"seu e-mail cadastrado":"seu celular"} para continuar.`),window.location.hash="#/login"}catch(r){console.error("❌ Recovery error:",r),P(r.message||"Erro ao enviar instruções. Tente novamente.")}finally{E(!1)}}function L(){p?.forEach(e=>{e.addEventListener("click",()=>{y||k(e.dataset.tab)})})}function x(){d?.addEventListener("input",e=>{e.target.value=C(e.target.value),a(s),m()}),f?.addEventListener("input",e=>{e.target.value=w(e.target.value),a(u),m()}),l?.addEventListener("input",()=>{a(c),m()})}function R(){if(g=document.getElementById("recoveryForm"),p=document.querySelectorAll(".recovery-tab"),b=document.querySelectorAll(".recovery-tab-content"),l=document.getElementById("emailInput"),d=document.getElementById("cpfInput"),f=document.getElementById("celularInput"),c=document.getElementById("emailError"),s=document.getElementById("cpfError"),u=document.getElementById("celularError"),n=document.getElementById("recoveryFormError"),v=g?.querySelector(".login-form-submit"),!g){console.error("Recovery form not found");return}g.addEventListener("submit",D),L(),x(),l?.focus(),console.log("✅ Password recovery page initialized")}export{R as init};
